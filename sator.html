<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Alpha Strike Hex Play Shot Solving Computer (S.A.T.O.R.)</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.0/css/bulma.min.css">
  <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
  <style>
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
      background-color: #2c2f34 !important; /* brighter neutral dark */
    }

    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    section.hero {
      flex: 1 0 auto;
    }

    footer.footer-fixed-bottom {
      background-color: #2c2f34 !important;
      color: #fff !important;
      flex-shrink: 0;
      width: 100%;
      padding: 1rem 0 0.5rem 0;
      box-sizing: border-box;
    }

    footer.footer-fixed-bottom .content,
    footer.footer-fixed-bottom p,
    footer.footer-fixed-bottom .has-text-centered {
      color: #fff !important;
    }
    /* Make active black buttons more visible on dark bg */
    .button.is-black.is-active, .button.is-black.is-inverted {
      background-color: #fff !important;
      color: #23272a !important;
      border: 1.5px solid #23272a !important;
    }
    .button.is-black {
      background-color: #23272a !important;
      color: #fff !important;
      border: 1.5px solid #fff !important;
    }

    @media (max-width: 900px) {
      #mainNav {
        display: flex !important;
        flex-direction: column !important;
        align-items: stretch !important;
        gap: 0.5rem !important;
      }
      #mainNav > .level-left, #mainNav > .level-right {
        min-width: 0 !important;
        width: 100% !important;
        flex: 1 1 100% !important;
        display: block !important;
      }
      #mainNav .level-item {
        width: 100% !important;
      }
    }
  </style>
</head>

<body>
  <section class="hero">
    <h1 class="subtitle has-text-white-ter has-text-centered">
      Alpha Strike Hex Play Shot Solving Computer (S.A.T.O.R.)
    </h1>
    <div class="container has-text-centered is-fluid is-marginless">
      <div class="tabs is-boxed is-fullwidth">
        <div class="container">
          <ul>
            <li class="tab is-active" onclick="openTab(event,'Gunnery')"><a
                class="has-text-white-ter has-background-primary-dark">S.</a></li>
            <li class="tab has-text-warning-dark" onclick="openTab(event,'Attacker')"><a
                class="has-text-white-ter has-background-info-dark">A.</a></li>
            <li class="tab has-text-success-dark" onclick="openTab(event,'Target')"><a
                class="has-text-white-ter has-background-success-dark">T.</a></li>
            <li class="tab has-text-info-dark" onclick="openTab(event,'Other')"><a
                class="has-text-white-ter has-background-warning-dark">O.</a></li>
            <li class="tab has-text-link-dark" onclick="openTab(event,'Range')"><a
                class="has-text-white-ter has-background-danger-dark">R.</a></li>
          </ul>
        </div>
      </div>
      <nav class="level is-mobile" id="mainNav">
        <div class="level-left" style="margin-right:0; min-width: 220px; flex: 1 1 300px;">
          <div class="level-item" style="margin-right:0; width:100%;">
            <table class="table is-fullwidth" id="viewTable" style="word-break:break-word;">
              <tbody>
                <tr>
                  <th>Skill</th>
                  <td>0</td>
                </tr>
                <tr>
                  <th>Attacker Movement</th>
                  <td>0</td>
                </tr>
                <tr>
                  <th>Target Movement</th>
                  <td>0</td>
                </tr>
                <tr>
                  <th>Other</th>
                  <td>0</td>
                </tr>
                <tr>
                  <th>Range</th>
                  <td>0</td>
                </tr>
                <tr>
                  <th>TN</th>
                  <td>Auto</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="level-right" style="margin-left:0; min-width: 220px; flex: 1 1 300px;">
          <div id="Gunnery" class="content-tab">
            <p class="subtitle has-text-white-ter">Select skill level.</p>
            <p>
              <a class="button is-rounded is-small is-black" onclick="updateGunnery(event, 1);">1</a>
              <a class="button is-rounded is-small is-black" onclick="updateGunnery(event, 2);">2</a>
              <a class="button is-rounded is-small is-black" onclick="updateGunnery(event, 3);">3</a>
              <a class="button is-rounded is-small is-black" onclick="updateGunnery(event, 4);">4</a>
              <a class="button is-rounded is-small is-black" onclick="updateGunnery(event, 5);">5</a>
              <a class="button is-rounded is-small is-black" onclick="updateGunnery(event, 6);">6</a>
            </p>
          </div>
          <div id="Attacker" class="content-tab" style="display:none">
            <p class="subtitle has-text-white-ter">Select Attacker movement.</p>
            <p>
              <a class="button is-rounded is-primary is-small"
                onclick="updateAttacker(event, 0, -1);">Stationary/Immobile</a>
              <a class="button is-rounded is-white is-small" onclick="updateAttacker(event, 1, 0);">Ground Movement
                (walk/run)</a>
              <a class="button is-rounded is-danger is-small" onclick="updateAttacker(event, 2, 2);">Jump</a>
            </p>
          </div>
          <div id="Target" class="content-tab" style="display:none">
            <p class="subtitle has-text-white-ter">Select TMM</p>
            <p>
            <div class="buttons has-addons is-right" id="targetBasic">
              <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 0);">0</a>
              <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 1);">1</a>
              <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 2);">2</a>
              <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 3);">3</a>
              <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 4);">4</a>
              <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 5);">5</a>
              <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 6);">6</a>
            </div>
            <div class="buttons has-addons is-right" id="targetJump">
              <a class="button is-rounded is-white is-small" onclick="updateTargetJump(event);">Jump</a>
            </div>
            <div class="buttons has-addons is-right" id="targetAdvanced">
              <a class="button is-rounded is-white is-small" onclick="updateTargetAdvanced(event, 0, -4);">Immobile</a>
            </div>
            </p>
          </div>
          <div id="Other" class="content-tab is-pulled-left" style="display:none">
            <div class="columns is-mobile">
              <div class="column">
                <p class="subtitle has-text-white-ter">Terrain</p>
              </div>
            </div>
            <div class="columns is-mobile">
              <div class="column is-narrow">
                <p class="has-text-white-ter">Woods between</p>
                <div class="buttons has-addons" id="woodsBetween">
                  <div class="field is-grouped">
                    <a class="button is-rounded is-white is-small" onclick="updateOther(event, 'woodsBetween', 0, 1);"
                      modValue=1>Light ‹3</a>
                    <a class="button is-rounded is-white is-small" onclick="updateOther(event, 'woodsBetween', 1, 2);"
                      modValue=2>Heavy ‹2</a>
                  </div>
                </div>
              </div>
              <div class="column is-narrow">
                <p class="has-text-white-ter">Target woods among</p>
                <div class="buttons has-addons" id="woodsAmong">
                  <div class="field is-grouped">
                    <a class="button is-rounded is-white is-small" onclick="updateOther(event, 'woodsAmong', 0, 1);"
                      modValue=1>Light</a>
                    <a class="button is-rounded is-white is-small" onclick="updateOther(event, 'woodsAmong', 1, 2);"
                      modValue=2>Heavy</a>
                    <a class="button is-rounded is-white is-small" onclick="updateOther(event, 'woodsAmong', 2, 3);"
                      modValue=3>Ultra-Heavy</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="columns is-mobile">
              <div class="column is-narrow">
                <div class="buttons has-addons" id="otherTerrain">
                  <div class="field is-grouped">
                    <a class="button is-rounded is-white is-small" onclick="updateOther(event, 'otherTerrain', 0, 1);"
                      modValue=1>Partial cover</a>
                    <a class="button is-rounded is-white is-small" onclick="updateOther(event, 'otherTerrain', 1, 1);"
                      modValue=1>Water Lv,1</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="columns is-mobile">
              <div class="column is-narrow">
                <!-- <p class="has-text-white-ter">2nd target</p> -->
                <div class="buttons has-addons" id="seconderyTarget">
                  <div class="field is-grouped">
                    <!-- <a class="button is-white is-small" onclick="updateOther(event, 'seconderyTarget', 0, 1);" modValue=1>forward arc</a> -->
                    <!-- <a class="button is-white is-small" onclick="updateOther(event, 'seconderyTarget', 1, 2);" modValue=2>side or rear arc</a> -->
                  </div>
                </div>
              </div>
              <div class="column is-narrow">
                <p class="has-text-white-ter">Attacker Heat</p>
                <div class="buttons has-addons" id="otherHeat">
                  <div class="field is-grouped">
                    <a class="button is-rounded is-white is-small" onclick="updateOther(event, 'otherHeat', 0, 0);"
                      modValue=0>0</a>
                    <a class="button is-rounded is-white is-small" onclick="updateOther(event, 'otherHeat', 1, 1);"
                      modValue=1>1</a>
                    <a class="button is-rounded is-white is-small" onclick="updateOther(event, 'otherHeat', 2, 2);"
                      modValue=2>2</a>
                    <a class="button is-rounded is-white is-small" onclick="updateOther(event, 'otherHeat', 3, 3);"
                      modValue=3>3</a>
                    <a class="button is-rounded is-white is-small" onclick="updateOther(event, 'otherHeat', 4, 4);"
                      modValue=4>4</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div id="Range" class="content-tab" style="display:none">
            <p class="subtitle has-text-white-ter">Select Range (Classic)</p>
            <div class="buttons has-addons is-right">
              <a class="button is-rounded is-white is-small" onclick="updateRange(event, 0, 0);">Short</a>
              <a class="button is-rounded is-success is-small" onclick="updateRange(event, 1, 2);">Medium +2</a>
              <a class="button is-rounded is-link is-small" onclick="updateRange(event, 2, 4);">Long +4</a>
            </div>
            <p class="subtitle has-text-white-ter">Select Range (EasyShot™)</p>
            <div class="buttons has-addons is-right">
              <a class="button is-rounded is-white is-small" onclick="updateRange(event, 3, 0);">Short</a>
              <a class="button is-rounded is-success is-small" onclick="updateRange(event, 4, 1);">Medium +1</a>
              <a class="button is-rounded is-link is-small" onclick="updateRange(event, 5, 2);">Long +2</a>
            </div>
            <p class="title is-1"><!-- White space for adjustment.--></p>
            <p class="subtitle is-6 has-text-white-ter">Manual Mod +</p>
            <div class="buttons has-addons is-right" id="manualModPlus">
              <div class="field is-grouped">
                <a class="button is-rounded is-white is-small" onclick="updateManualModPlus(event, 0, 0);" modValue=0>+0</a>
                <a class="button is-rounded is-white is-small" onclick="updateManualModPlus(event, 1, 1);" modValue=1>+1</a>
                <a class="button is-rounded is-white is-small" onclick="updateManualModPlus(event, 2, 2);" modValue=2>+2</a>
                <a class="button is-rounded is-white is-small" onclick="updateManualModPlus(event, 3, 3);" modValue=3>+3</a>
                <a class="button is-rounded is-white is-small" onclick="updateManualModPlus(event, 4, 4);" modValue=4>+4</a>
                <a class="button is-rounded is-white is-small" onclick="updateManualModPlus(event, 5, 5);" modValue=5>+5</a>
                <a class="button is-rounded is-white is-small" onclick="updateManualModPlus(event, 6, 6);" modValue=6>+6</a>
              </div>
            </div>
            <p class="subtitle is-6 has-text-white-ter">Manual Mod -</p>
            <div class="buttons has-addons is-right" id="manualModMinus">
              <div class="field is-grouped">
                <a class="button is-rounded is-white is-small" onclick="updateManualModMinus(event, 0, 0);" modValue=0>-0</a>
                <a class="button is-rounded is-white is-small" onclick="updateManualModMinus(event, 1, -1);" modValue=-1>-1</a>
                <a class="button is-rounded is-white is-small" onclick="updateManualModMinus(event, 2, -2);" modValue=-2>-2</a>
                <a class="button is-rounded is-white is-small" onclick="updateManualModMinus(event, 3, -3);" modValue=-3>-3</a>
                <a class="button is-rounded is-white is-small" onclick="updateManualModMinus(event, 4, -4);" modValue=-4>-4</a>
                <a class="button is-rounded is-white is-small" onclick="updateManualModMinus(event, 5, -5);" modValue=-5>-5</a>
                <a class="button is-rounded is-white is-small" onclick="updateManualModMinus(event, 6, -6);" modValue=-6>-6</a>
              </div>
            </div>
          </div>
        </div>
      </nav>
    </div>
  </section>
  <footer class="footer-fixed-bottom">
    <div class="content has-text-centered">
      <p id="appVersion"></p>
    </div>
  </footer>
</body>
<script>
  const appVersion = '0.9.3b';
  window.onload = function() {
    var versionElem = document.getElementById('appVersion');
    if (versionElem) {
      versionElem.innerHTML = 'app version: ' + appVersion;
    }
  };

  function openTab(evt, tabName) {
    var i, x, tablinks;
    x = document.getElementsByClassName("content-tab");
    for (i = 0; i < x.length; i++) {
      x[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tab");
    for (i = 0; i < x.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" is-active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " is-active";
  };

  function selectUntilNumberButton(evt, id, num) {
    var elem = document.getElementById(id);
    var buttons = elem.getElementsByClassName("button");
    for (i = 0; i < buttons.length; i++) {
      buttons[i].className = buttons[i].className.replace(" is-active", "");
      buttons[i].className = buttons[i].className.replace(" is-black", "");
    }
    for (i = 0; i < num; i++) {
      buttons[i].className += " is-black";
      buttons[i].className += " is-active";
    }
  }

  function selectButton(evt, id, num, eraseAttribute, selectAttribute) {
    var elem = document.getElementById(id);
    var buttons = elem.getElementsByClassName("button");
    eraseAttribute = eraseAttribute ? eraseAttribute : " is-inverted";
    selectAttribute = selectAttribute ? " " + selectAttribute : " is-inverted";
    for (i = 0; i < buttons.length; i++) {
      buttons[i].className = buttons[i].className.replace(eraseAttribute, "");
    }
    buttons[num].className += selectAttribute;
    return selectAttribute;
  }

  function setTableValue(evt, id, row, col, value) {
    var elem = document.getElementById(id);
    elem.rows[row].cells[col].firstChild.data = value;
  }

  var manualModPlus = 0;
  var manualModMinus = 0;

  function sumModifierValue() {
    var elem = document.getElementById('viewTable');
    var sum = 0;
    // Sum Skill, Attacker, Target, Other, Range
    for (var i = 0; i <= 4; i++) {
      sum += Number(elem.rows[i].cells[1].firstChild.data);
    }
    // Add hidden manual mods
    sum += manualModPlus;
    sum += manualModMinus;

    // Write result to TN row (row 5)
    var tnRow = 5;
    if (sum <= 2) {
      sum = "Auto"
    }
    else if (sum >= 13) {
      sum = "No Chance";
    }
    else {
      sum = sum + "+";
    }
    setTableValue(event, 'viewTable', tnRow, 1, sum)
  }

  function updateGunnery(evt, num) {
    selectUntilNumberButton(evt, 'Gunnery', num);
    setTableValue(evt, 'viewTable', 0, 1, num);
    sumModifierValue();
  }

  function updateAttacker(evt, num, value) {
    selectButton(event, 'Attacker', num);
    var table = document.getElementById('viewTable');
    table.rows[1].cells[1].firstChild.data = value;
    sumModifierValue();
  }

  function updateTarget(evt, num) {
    selectButton(event, 'targetBasic', num);
    //If advanced is on, turn off advanced.
    var elem = document.getElementById('targetAdvanced');
    var buttons = elem.getElementsByClassName("button");
    for (i = 0; i < buttons.length; i++) {
      buttons[i].className = buttons[i].className.replace(" is-inverted", "");
    }
    //If jump is on, add +1.
    elem = document.getElementById('targetJump');
    buttons = elem.getElementsByClassName("button");
    if (buttons[0].className.indexOf(" is-inverted") != -1) {
      num = num + 1;
    }
    setTableValue(event, 'viewTable', 2, 1, num)
    sumModifierValue();
  }
  function updateTargetJump(evt) {
    //Do not turn on, when advanced is on.
    var elem = document.getElementById('targetAdvanced');
    var buttons = elem.getElementsByClassName("button");
    var isAdvancedOn = false;
    for (i = 0; i < buttons.length; i++) {
      if (buttons[i].className.indexOf(" is-inverted") != -1) {
        isAdvancedOn = true;
      }
    }

    if (isAdvancedOn) {
    }
    else {
      var elem = document.getElementById('targetJump');
      var buttons = elem.getElementsByClassName("button");
      var table = document.getElementById("viewTable");
      if (buttons[0].className.indexOf(" is-inverted") != -1) {
        buttons[0].className = buttons[0].className.replace(" is-inverted", "");
        table.rows[2].cells[1].firstChild.data = Number(table.rows[2].cells[1].firstChild.data) - 1;
      }
      else {
        buttons[0].className += " is-inverted";
        table.rows[2].cells[1].firstChild.data = Number(table.rows[2].cells[1].firstChild.data) + 1;
      }
    }
    sumModifierValue();
  }
  function updateTargetAdvanced(evt, num, value) {
    selectButton(event, 'targetAdvanced', num);
    var elem = document.getElementById('targetBasic');
    var buttons = elem.getElementsByClassName("button");
    for (i = 0; i < buttons.length; i++) {
      buttons[i].className = buttons[i].className.replace(" is-inverted", "");
    }
    elem = document.getElementById('targetJump');
    buttons = elem.getElementsByClassName("button");
    buttons[0].className = buttons[0].className.replace(" is-inverted", "");
    setTableValue(event, 'viewTable', 2, 1, value)
    sumModifierValue();
  }

  function updateOther(evt, targetId, index, value) {
    //Get selected button index, and modValue.
    var elem = document.getElementById(targetId);
    var buttons = elem.getElementsByClassName("button");
    var subtractValue = 0;
    var unselect = false;
    var i = 0;
    for (i = 0; i < buttons.length; i++) {
      if (buttons[i].className.indexOf(" is-inverted") != -1) {
        subtractValue = Number(buttons[i].attributes.modValue.value);
        if (i == index) {
          unselect = true;
        }
      }
      buttons[i].className = buttons[i].className.replace(" is-inverted", "");
    }
    //If selected index equal parameter index, do unselect.
    var table = document.getElementById("viewTable");
    if (unselect) {
      table.rows[3].cells[1].firstChild.data = Number(table.rows[3].cells[1].firstChild.data) - subtractValue;
    }
    else {
      buttons[index].className += " is-inverted";
      table.rows[3].cells[1].firstChild.data = Number(table.rows[3].cells[1].firstChild.data) - subtractValue + value;
    }
    sumModifierValue();
  }

  var prevSelectRangeAttribute;
  function updateRange(evt, num, value, selectAttribute) {
    prevSelectRangeAttribute = selectButton(event, 'Range', num, prevSelectRangeAttribute, selectAttribute);
    setTableValue(event, 'viewTable', 4, 1, value)
    sumModifierValue();
  }

  function updateManualModPlus(evt, index, value) {
    var elem = document.getElementById('manualModPlus');
    var buttons = elem.getElementsByClassName("button");
    var subtractValue = 0;
    var unselect = false;
    for (var i = 0; i < buttons.length; i++) {
      if (buttons[i].className.indexOf(" is-inverted") != -1) {
        subtractValue = Number(buttons[i].attributes.modValue.value);
        if (i == index) {
          unselect = true;
        }
      }
      buttons[i].className = buttons[i].className.replace(" is-inverted", "");
    }
    if (unselect) {
      manualModPlus = 0;
    } else {
      buttons[index].className += " is-inverted";
      manualModPlus = value;
    }
    sumModifierValue();
  }
  function updateManualModMinus(evt, index, value) {
    var elem = document.getElementById('manualModMinus');
    var buttons = elem.getElementsByClassName("button");
    var subtractValue = 0;
    var unselect = false;
    for (var i = 0; i < buttons.length; i++) {
      if (buttons[i].className.indexOf(" is-inverted") != -1) {
        subtractValue = Number(buttons[i].attributes.modValue.value);
        if (i == index) {
          unselect = true;
        }
      }
      buttons[i].className = buttons[i].className.replace(" is-inverted", "");
    }
    if (unselect) {
      manualModMinus = 0;
    } else {
      buttons[index].className += " is-inverted";
      manualModMinus = value;
    }
    sumModifierValue();
  }
</script>

</html>