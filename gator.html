<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Battletech G.A.T.O.R. Template</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.0/css/bulma.min.css">
  <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
</head>
<body>
  <section class="hero has-background-grey-dark is-fullheight">
    <h1 class="subtitle has-text-white-ter">
      Battletech Shot Solving Computer
    </h1>
    <div class="container has-text-centered is-fluid is-marginless">
      <div class="tabs is-boxed is-fullwidth">
        <div class="container">
          <ul>
            <li class="tab is-active" onclick="openTab(event,'Gunnery')"><a class="has-text-white-ter has-background-primary-dark">G.</a></li>
            <li class="tab has-text-warning-dark" onclick="openTab(event,'Attacker')"><a class="has-text-white-ter has-background-info-dark">A.</a></li>
            <li class="tab has-text-success-dark" onclick="openTab(event,'Target')"><a class="has-text-white-ter has-background-success-dark">T.</a></li>
            <li class="tab has-text-info-dark" onclick="openTab(event,'Other')"><a class="has-text-white-ter has-background-warning-dark">O.</a></li>
            <li class="tab has-text-link-dark" onclick="openTab(event,'Range')"><a class="has-text-white-ter has-background-danger-dark">R.</a></li>
          </ul>
        </div>
      </div>
      <nav class="level">
        <div class="level-left">
          <div class="level-item">
            <table class="table" id="viewTable">
              <tbody>
                <tr><th>Gunnary Skill</th><td>0</td></tr>
                <tr><th>Attacker Movement</th><td>0</td></tr>
                <tr><th>Target Movement</th><td>0</td></tr>
                <tr><th>Other</th><td>0</td></tr>
                <tr><th>Range</th><td>0</td></tr>
                <tr><th>Modifier</th><td>Auto</td></tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="level-right">
          <div id="Gunnery" class="content-tab" >
            <p class="subtitle has-text-white-ter">Select Gunnery skill.</p>
            <p>
              <a class="button is-rounded is-small" onclick="updateGunnery(event, 1);">1</a>
              <a class="button is-rounded is-small" onclick="updateGunnery(event, 2);">2</a>
              <a class="button is-rounded is-small" onclick="updateGunnery(event, 3);">3</a>
              <a class="button is-rounded is-small" onclick="updateGunnery(event, 4);">4</a>
              <a class="button is-rounded is-small" onclick="updateGunnery(event, 5);">5</a>
              <a class="button is-rounded is-small" onclick="updateGunnery(event, 6);">6</a>
            </p>
          </div>
          <div id="Attacker" class="content-tab" style="display:none">
            <p class="subtitle has-text-white-ter">Select Attacker movement.</p>
            <p>
              <a class="button is-rounded is-primary is-small" onclick="updateAttacker(event, 0, 0);">Stationary</a>
              <a class="button is-rounded is-white is-small" onclick="updateAttacker(event, 1, 1);">Walk</a>
              <a class="button is-rounded is-black is-small" onclick="updateAttacker(event, 2, 2);">Run</a>
              <a class="button is-rounded is-danger is-small" onclick="updateAttacker(event, 3, 3);">Jump</a>
              <a class="button is-rounded is-warning is-small" onclick="updateAttacker(event, 4, 2);">Prone</a>
            </p>
          </div>
          <div id="Target" class="content-tab" style="display:none">
            <p class="subtitle has-text-white-ter">Select Target movement.</p>
            <p>
              <div class="buttons has-addons is-right" id="targetBasic">
                <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 0);">0 - 2</a>
                <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 1);">3 - 4</a>
                <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 2);">5 - 6</a>
                <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 3);">7 - 9</a>
                <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 4);">10 - 17</a>
                <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 5);">18 - 24</a>
                <a class="button is-rounded is-white is-small" onclick="updateTarget(event, 6);">25 -</a>
              </div>
              <div class="buttons has-addons is-right" id="targetJump">
                <a class="button is-rounded is-white is-small" onclick="updateTargetJump(event);">Jump</a>
              </div>
              <div class="buttons has-addons is-right" id="targetAdvanced">
                <a class="button is-rounded is-white is-small" onclick="updateTargetAdvanced(event, 0, -2);">Prone(Adjacent)</a>
                <a class="button is-rounded is-white is-small" onclick="updateTargetAdvanced(event, 1, 1);">Prone</a>
                <a class="button is-rounded is-white is-small" onclick="updateTargetAdvanced(event, 2, -4);">Immobile</a>
              </div>
            </p>
          </div>
          <div id="Other" class="content-tab is-pulled-left" style="display:none">
            <div class="columns is-mobile">
              <div class="column">
                <p class="subtitle has-text-white-ter">Terrain</p>
              </div>
            </div>
            <div class="columns is-mobile">
              <div class="column is-narrow">
                <p class="has-text-white-ter">Woods between</p>
                <div class="buttons has-addons" id="woodsBetween">
                  <div class="field is-grouped">
                    <a class="button is-white is-small" onclick="updateOther(event, 'woodsBetween', 0, 1);" modValue=1>Lv,1</a>
                    <a class="button is-white is-small" onclick="updateOther(event, 'woodsBetween', 1, 2);" modValue=2>Lv,2</a>
                    <a class="button is-white is-small" onclick="updateOther(event, 'woodsBetween', 2, 2);" modValue=2>Lv,1 x 2</a>
                  </div>
                </div>
              </div>
              <div class="column is-narrow">
                <p class="has-text-white-ter">Woods among</p>
                <div class="buttons has-addons" id="woodsAmong">
                  <div class="field is-grouped">
                    <a class="button is-white is-small" onclick="updateOther(event, 'woodsAmong', 0, 1);" modValue=1>Lv,1</a>
                    <a class="button is-white is-small" onclick="updateOther(event, 'woodsAmong', 1, 2);" modValue=2>Lv,2</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="columns is-mobile">
              <div class="column is-narrow">
                <div class="buttons has-addons" id="otherTerrain">
                  <div class="field is-grouped">
                    <a class="button is-white is-small" onclick="updateOther(event, 'otherTerrain', 0, 1);" modValue=1>Partial cover</a>
                    <a class="button is-white is-small" onclick="updateOther(event, 'otherTerrain', 1, 1);" modValue=1>Water Lv,1</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="columns is-mobile">
              <div class="column is-narrow">
                <p class="has-text-white-ter">2nd target</p>
                <div class="buttons has-addons" id="seconderyTarget">
                  <div class="field is-grouped">
                    <a class="button is-white is-small" onclick="updateOther(event, 'seconderyTarget', 0, 1);" modValue=1>forward arc</a>
                    <a class="button is-white is-small" onclick="updateOther(event, 'seconderyTarget', 1, 2);" modValue=2>side or rear arc</a>
                  </div>
                </div>
              </div>
              <div class="column is-narrow">
                <p class="has-text-white-ter">Heat</p>
                <div class="buttons has-addons" id="otherHeat">
                  <div class="field is-grouped">
                    <a class="button is-white is-small" onclick="updateOther(event, 'otherHeat', 0, 1);" modValue=1>&lE; 8</a>
                    <a class="button is-white is-small" onclick="updateOther(event, 'otherHeat', 1, 2);" modValue=2>&lE;13</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div id="Range" class="content-tab" style="display:none">
            <p class="subtitle has-text-white-ter">Select Range.</p>
            <div class="buttons has-addons is-right">
              <a class="button is-rounded is-white is-small" onclick="updateRange(event, 0, 0);">Short</a>
              <a class="button is-rounded is-success is-small" onclick="updateRange(event, 1, 2);">Medium</a>
              <a class="button is-rounded is-link is-small" onclick="updateRange(event, 2, 4);">Long</a>
            </div>
            <p class="title is-1"><!-- White space for adjustment.--></p>
            <p class="subtitle is-6 has-text-white-ter">Minimum</p>
            <div class="buttons has-addons is-right">
              <a class="button is-rounded is-warning is-small" onclick="updateRange(event, 3, 1, 'is-inverted');">Equal</a>
              <a class="button is-rounded is-warning is-small" onclick="updateRange(event, 4, 2, 'is-inverted');">-1</a>
              <a class="button is-rounded is-warning is-small" onclick="updateRange(event, 5, 3, 'is-inverted');">-2</a>
              <a class="button is-rounded is-warning is-small" onclick="updateRange(event, 6, 4, 'is-inverted');">-3</a>
              <a class="button is-rounded is-warning is-small" onclick="updateRange(event, 7, 5, 'is-inverted');">-4</a>
              <a class="button is-rounded is-warning is-small" onclick="updateRange(event, 8, 6, 'is-inverted');">-5</a>
            </div>
          </div>
        </div>
      </nav>
    </div>
  </section>
</body>
  <script>
    function openTab(evt, tabName){
      var i, x, tablinks;
      x = document.getElementsByClassName("content-tab");
      for (i = 0; i < x.length; i++) {
        x[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tab");
      for (i = 0; i < x.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" is-active", "");
      }
      document.getElementById(tabName).style.display = "block";
      evt.currentTarget.className += " is-active";
    };

    function selectUntilNumberButton(evt, id, num){
      var elem = document.getElementById(id);
      var buttons = elem.getElementsByClassName("button");
      for (i = 0; i < buttons.length; i++) {
        buttons[i].className = buttons[i].className.replace(" is-active", "");
        buttons[i].className = buttons[i].className.replace(" is-black", "");
      }
      for (i = 0; i < num; i++) {
        buttons[i].className += " is-black";
        buttons[i].className += " is-active";
      }
    }

    function selectButton(evt, id, num, eraseAttribute, selectAttribute){
      var elem = document.getElementById(id);
      var buttons = elem.getElementsByClassName("button");
      eraseAttribute = eraseAttribute ? eraseAttribute : " is-inverted";
      selectAttribute = selectAttribute ? " " + selectAttribute : " is-inverted";
      for (i = 0; i < buttons.length; i++) {
        buttons[i].className = buttons[i].className.replace(eraseAttribute, "");
      }
      buttons[num].className += selectAttribute;
      return selectAttribute;
    }

    function setTableValue(evt, id, row, col, value){
      var elem = document.getElementById(id);
      elem.rows[row].cells[col].firstChild.data = value;
    }

    function sumModifierValue(){
      var elem = document.getElementById('viewTable');
      var sum = 0;
      for(var i = 0; i < elem.rows.length - 1; i++){
        sum += Number(elem.rows[i].cells[1].firstChild.data);
      }
      if( sum <= 2){
        sum = "Auto"
      }
      else if( sum >= 13){
        sum = "No Chance";
      }
      else{
        sum = sum + "+";
      }
      setTableValue(event, 'viewTable', 5, 1, sum)
    }

    function updateGunnery(evt, num){
      selectUntilNumberButton(evt, 'Gunnery', num);
      setTableValue(evt, 'viewTable', 0, 1, num);
      sumModifierValue();
    }

    function updateAttacker(evt, num, value){
      selectButton(event, 'Attacker', num);
      setTableValue(event, 'viewTable', 1, 1, value)
      sumModifierValue();
    }

    function updateTarget(evt, num){
      selectButton(event, 'targetBasic', num);
      //If advanced is on, turn off advanced.
      var elem = document.getElementById('targetAdvanced');
      var buttons = elem.getElementsByClassName("button");
      for (i = 0; i < buttons.length; i++) {
        buttons[i].className = buttons[i].className.replace(" is-inverted", "");
      }
      //If jump is on, add +1.
      elem = document.getElementById('targetJump');
      buttons = elem.getElementsByClassName("button");
      if(buttons[0].className.indexOf(" is-inverted") != -1){
        num = num + 1;
      }
      setTableValue(event, 'viewTable', 2, 1, num)
      sumModifierValue();
    }
    function updateTargetJump(evt){
      //Do not turn on, when advanced is on.
      var elem = document.getElementById('targetAdvanced');
      var buttons = elem.getElementsByClassName("button");
      var isAdvancedOn = false;
      for (i = 0; i < buttons.length; i++) {
        if(buttons[i].className.indexOf(" is-inverted") != -1){
          isAdvancedOn = true;
        }
      }

      if(isAdvancedOn){
      }
      else{
        var elem = document.getElementById('targetJump');
        var buttons = elem.getElementsByClassName("button");
        elem = document.getElementById("viewTable");
        if(buttons[0].className.indexOf(" is-inverted") != -1){
          buttons[0].className = buttons[0].className.replace(" is-inverted", "");
          elem.rows[2].cells[1].firstChild.data = Number(elem.rows[2].cells[1].firstChild.data) - 1;
        }
        else{
          buttons[0].className += " is-inverted";
          elem.rows[2].cells[1].firstChild.data = Number(elem.rows[2].cells[1].firstChild.data) + 1;
        }
      }
      sumModifierValue();
    }
    function updateTargetAdvanced(evt, num, value){
      selectButton(event, 'targetAdvanced', num);
      var elem = document.getElementById('targetBasic');
      var buttons = elem.getElementsByClassName("button");
      for (i = 0; i < buttons.length; i++) {
        buttons[i].className = buttons[i].className.replace(" is-inverted", "");
      }
      elem = document.getElementById('targetJump');
      buttons = elem.getElementsByClassName("button");
      buttons[0].className = buttons[0].className.replace(" is-inverted", "");
      setTableValue(event, 'viewTable', 2, 1, value)
      sumModifierValue();
    }

    function updateOther(evt, targetId, index, value){
      //Get selected button index, and modValue.
      var elem = document.getElementById(targetId);
      var buttons = elem.getElementsByClassName("button");
      var subtractValue = 0;
      var unselect = false;
      var i = 0;
      for (i = 0; i < buttons.length; i++) {
        if(buttons[i].className.indexOf(" is-inverted") != -1){
          subtractValue = Number(buttons[i].attributes.modValue.value);
          if(i == index){
            unselect = true;
          }
        }
        buttons[i].className = buttons[i].className.replace(" is-inverted", "");
      }
      //If selected index equal parameter index, do unselect.
      var table = document.getElementById("viewTable");
      if(unselect){
        table.rows[3].cells[1].firstChild.data = Number(table.rows[3].cells[1].firstChild.data) - subtractValue;
      }
      else{
        buttons[index].className += " is-inverted";
        table.rows[3].cells[1].firstChild.data = Number(table.rows[3].cells[1].firstChild.data) - subtractValue + value;
      }
      sumModifierValue();
    }

    var prevSelectRangeAttribute;
    function updateRange(evt, num, value, selectAttribute){
      prevSelectRangeAttribute = selectButton(event, 'Range', num, prevSelectRangeAttribute, selectAttribute);
      setTableValue(event, 'viewTable', 4, 1, value)
      sumModifierValue();
    }
  </script>
</html>
